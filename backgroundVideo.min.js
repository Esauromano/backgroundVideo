!function(i,t,o,e){"use strict";function n(t,o){function e(){n.options.originalVideoW=n.options.$video[0].videoWidth,n.options.originalVideoH=n.options.$video[0].videoHeight,n.initialised||n.init()}var n=this;this.element=t,this.options=i.extend({},r,o),this._defaults=r,this._name=s,this.options.$video=i(t),this.detectBrowser(),this.shimRequestAnimationFrame(),this.options.has3d=this.detect3d(),this.options.$videoWrap.css({position:"relative",overflow:"hidden","z-index":"10"}),this.options.$video.css({position:"absolute","z-index":"1"}),this.options.$video.on("canplay canplaythrough",e),this.options.$video[0].readyState>3&&e()}var s="backgroundVideo",r={$videoWrap:i("#video-wrap"),$outerWrap:i(t),$window:i(t),minimumVideoWidth:400,preventContextMenu:!1,parallax:!0,parallaxOptions:{effect:1.5},pauseVideoOnViewLoss:!1};n.prototype={init:function(){var i=this;this.initialised=!0,this.lastPosition=-1,this.options.$window.resize(function(){i.positionObject(i.options.$video)}),this.options.parallax&&this.update(),this.options.pauseVideoOnViewLoss&&this.playPauseVideo(),this.options.preventContextMenu&&this.options.$video.on("contextmenu",function(){return!1}),this.options.$window.trigger("resize")},update:function(){var i=this;return this.lastPosition==t.pageYOffset?(t.requestAnimationFrame(i.update.bind(i)),!1):(this.lastPosition=t.pageYOffset,this.positionObject(i.options.$video),void this.update())},shimRequestAnimationFrame:function(){for(var i=0,o=["ms","moz","webkit","o"],e=0;e<o.length&&!t.requestAnimationFrame;++e)t.requestAnimationFrame=t[o[e]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[o[e]+"CancelAnimationFrame"]||t[o[e]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(o){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),s=t.setTimeout(function(){o(e+n)},n);return i=e+n,s}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(i){clearTimeout(i)})},detect3d:function(){var i,n,s=o.createElement("p"),r={WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MSTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};o.body.insertBefore(s,o.body.lastChild);for(i in r)s.style[i]!==e&&(s.style[i]="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",n=t.getComputedStyle(s).getPropertyValue(r[i]));return s.parentNode.removeChild(s),n!==e?"none"!==n:!1},detectBrowser:function(){var i=navigator.userAgent.toLowerCase();i.indexOf("chrome")>-1||i.indexOf("safari")>-1?(this.options.browser="webkit",this.options.browserPrexix="-webkit-"):i.indexOf("firefox")>-1?(this.options.browser="firefox",this.options.browserPrexix="-moz-"):-1!==i.indexOf("MSIE")||i.indexOf("Trident/")>0?(this.options.browser="ie",this.options.browserPrexix="-ms-"):i.indexOf("Opera")>-1&&(this.options.browser="opera",this.options.browserPrexix="-o-")},scaleObject:function(i,t){var o,e,n;return t.width(this.options.$outerWrap.width()),t.height(this.options.$outerWrap.height()),o=this.options.$window.width()/this.options.originalVideoW,e=this.options.$window.height()/this.options.originalVideoH,n=o>e?o:e,n*this.options.originalVideoW<this.options.minimumVideoWidth&&(n=this.options.minimumVideoWidth/this.options.originalVideoW),i.width(n*this.options.originalVideoW),i.height(n*this.options.originalVideoH),{xPos:-(parseInt(i.width()-this.options.$window.width())/2),yPos:parseInt(i.height()-this.options.$window.height())/2}},positionObject:function(i){var t=this,o=this.options.$window.scrollTop(),e=this.scaleObject(i,t.options.$videoWrap),n=e.xPos,s=e.yPos;s=this.options.parallax?o>=0?this.calculateYPos(s,o):this.calculateYPos(s,0):-s,t.options.has3d?(i.css(t.options.browserPrexix+"transform3d","translate3d(-"+n+"px, "+s+"px, 0)"),i.css("transform","translate3d("+n+"px, "+s+"px, 0)")):(i.css(t.options.browserPrexix+"transform","translate(-"+n+"px, "+s+"px)"),i.css("transform","translate("+n+"px, "+s+"px)"))},calculateYPos:function(i,t){var o,e;return o=parseInt(this.options.$videoWrap.offset().top),e=o-t,i=-(e/this.options.parallaxOptions.effect+i)},disableParallax:function(){this.options.$window.unbind(".backgroundVideoParallax")},playPauseVideo:function(){var i=this;this.options.$window.on("scroll.backgroundVideoPlayPause",function(){i.options.$window.scrollTop()<i.options.$videoWrap.height()?i.options.$video.get(0).play():i.options.$video.get(0).pause()})}},i.fn[s]=function(t){return this.each(function(){i.data(this,"plugin_"+s)||i.data(this,"plugin_"+s,new n(this,t))})}}(jQuery,window,document);